---
import { getCollection } from 'astro:content';
import BaseLayout from '../components/BaseLayout.astro';
import PageSection from '../components/PageSection.astro';
import Hero from '../components/Hero.astro';
import ProjectCard from '../components/ProjectCard.astro';
import ProjectList from '../components/ProjectList.astro';
import ProjectModal from '../components/ProjectModal.astro';
import About from '../components/About.astro';
import Contact from '../components/Contact.astro';

// Your social links - customize these
const socialLinks = [
	{ label: "GitHub", url: "https://github.com/AdarshDalai" },
	{ label: "LinkedIn", url: "https://linkedin.com/in/adarshkumardalai" },
	{ label: "Twitter", url: "https://twitter.com/DalainotLama" },
	{ label: "Email", url: "mailto:adarshkumardalai@gmail.com" },
];

// Fetch all projects from content collection
const allProjects = await getCollection('projects', ({ data }) => {
	return data.draft !== true;
});

// Sort by order (lower numbers first), then by title
const projects = allProjects.sort((a, b) => {
	if (a.data.order !== b.data.order) {
		return a.data.order - b.data.order;
	}
	return a.data.title.localeCompare(b.data.title);
});
---

<BaseLayout title="Adarsh Kumar Dalai" description="Software Developer Portfolio">
	
	<PageSection id="hero">
		<Hero 
			name="Adarsh Kumar Dalai"
			tagline="Developer. Builder. Petrolhead.<br/>I drive fast and code faster."
			links={socialLinks}
		/>
	</PageSection>

	<PageSection id="projects">
		<h2 class="section-title">Projects</h2>
		<ProjectList>
			{projects.map(async (project) => {
				const { Content } = await project.render();
				return (
					<ProjectCard 
						id={project.slug}
						title={project.data.title}
						subtitle={project.data.subtitle}
						image={`/images/${project.data.image}`}
						techStack={project.data.techStack}
						githubUrl={project.data.githubUrl}
						liveUrl={project.data.liveUrl}
					>
						<Content />
					</ProjectCard>
				);
			})}
		</ProjectList>
	</PageSection>

	<PageSection id="about">
		<h2 class="section-title">About</h2>
		<About>
			<p>
				I'm a software developer based in India. I enjoy building web applications 
				and exploring new technologies. Currently focused on full-stack development.
			</p>
			<p>
				When I'm not coding, you can find me reading, exploring, or learning something new.
			</p>
		</About>
	</PageSection>

	<PageSection id="contact">
		<h2 class="section-title">Get in touch</h2>
		<Contact email="adarshkumardalai@gmail.com">
			<p>Want to work together or just say hi?</p>
		</Contact>
		<p class="copyright">Â© 2025 Adarsh Kumar Dalai</p>
	</PageSection>
	
	<ProjectModal />
</BaseLayout>

<style>
	.section-title {
		font-size: clamp(1.75rem, 6vw, 3.5rem);
		margin-bottom: clamp(1.5rem, 4vw, 3rem);
		letter-spacing: -0.02em;
	}

	.copyright {
		position: absolute;
		bottom: clamp(1rem, 3vw, 2rem);
		left: 50%;
		transform: translateX(-50%);
		font-size: clamp(0.7rem, 1.5vw, 0.875rem);
		color: var(--text-muted);
	}
</style>
